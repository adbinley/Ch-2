bxp
outliers.mig <- migrants_2019 %>%
group_by(season, diet2) %>%
identify_outliers(IHM) # 20 outliers
#normality
#using qq since sample size relatively large
ggqqplot(migrants_2019, "IHM", ggtheme = theme_bw()) +
facet_grid(season ~ diet2)
#homogeneity of variances
migrants_2019 %>%
group_by(season) %>%
levene_test(IHM ~ diet2)
#good except nonbreeding
ggplot(migrants_2019, aes(y=IHM, x=diet2))+
geom_point() +
facet_wrap(~season)
#homogeneity of covariances
box_m(migrants_2019[, "IHM", drop = FALSE], migrants_2019$diet2)
#### post-hoc comparisons ####
mig.diet.tukey.table <- emmeans(mig.diet.lmer, list(pairwise ~ diet2*season), adjust = "holm")
summary(mig.diet.tukey.table)
write.table(mig.diet.tukey.table$`pairwise differences of diet2, season`, file = "fig_outputs/diet-tuk-rpi.txt", sep = ",", quote = FALSE, row.names = F)
rsquared(mig.diet.lmer)
#rsquared.glmm(mig.stat.lmer)
AIC(mig.stat.lmer)
#rsquared.glmm(mig.stat.lmer)
AIC(mig.diet.lmer)
load("data/species_basic.RData")
load("data_outputs/bootstrap_all.RData")
all_data <- left_join(bootstrap_all,species_basic,by="species_code")
all_data1 <- all_data %>%
group_by(season, diet2, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3_diet <- all_data1 %>%
pivot_longer(!c("season","diet2","state"), names_to = "No.", values_to = "PD" )
all_data4_diet <- all_data3_diet %>%
pivot_wider(names_from = "state", values_from = "PD")
all_data4_diet <- all_data4_diet %>%
mutate(SHM = (natural+1)/(modified+1))
all_data4_diet$season <- factor(all_data4_diet$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
pd_aov <- aov(SHM~season*diet2, data = all_data4_diet)
pd_lm <- lm(SHM~season*diet2, data = all_data4_diet)
summary(pd_aov)
summary(pd_lm)
AIC(pd_lm)
#assumptions
par(mfrow=c(2,2))
plot(pd_lm)
diet.tukey.pd.table <- emmeans(pd_aov, list(pairwise ~ diet2*season), adjust = "holm")
summary(diet.tukey.pd.table)
write.table(diet.tukey.pd.table$`pairwise differences of diet2, season`, file = "fig_outputs/diet-holm-pd.txt", sep = ",", quote = FALSE, row.names = F)
#### foraging ####
load("data_outputs/IHM_migrants_2019.RData")
#mig.for.lme <- lme(SHM ~ season*sw_foraging, data = migrants, random = ~ 1 | species_code)
#summary(mig.for.lme)
#anova(mig.diet.lme)
#summary(aov(SHM ~ season*diet2 + Error(species_code), data = migrants))
#lme4
mig.for.lmer <- lmer(IHM ~ season*sw_foraging + (1 | species_code), data = migrants_2019)
summary(mig.for.lmer)
anova(mig.for.lmer)
AIC(mig.for.lmer)
rsquared(mig.for.lmer)
AIC(mig.for.lmer)
#boxplot suggests outliers
#particularly in insectivores postbreeding
bxp <- ggboxplot(
migrants_2019, x = "season", y = "IHM",
color = "sw_foraging", palette = "jco"
)
bxp
outliers.mig <- migrants_2019 %>%
group_by(season, sw_foraging) %>%
identify_outliers(IHM)
#normality
#using qq since sample size relatively large
ggqqplot(migrants_2019, "IHM", ggtheme = theme_bw()) +
facet_grid(season ~ sw_foraging)
#homogeneity of variances
migrants_2019 %>%
group_by(season) %>%
levene_test(IHM ~ sw_foraging)
#assumptions met
ggplot(migrants_2019, aes(y=IHM, x=sw_foraging))+
geom_point() +
facet_wrap(~season)
#homogeneity of covariances
box_m(migrants_2019[, "IHM", drop = FALSE], migrants_2019$sw_foraging)
##post-hoc comparisons
for.holm.rpi <- emmeans(mig.for.lmer, list(pairwise ~ sw_foraging*season), adjust = "holm")
summary(for.holm.rpi)
write.table(for.holm.rpi$`pairwise differences of sw_foraging, season`, file = "fig_outputs/rPI-for-holm.txt", sep = ",", quote = FALSE, row.names = F)
load("data/species_basic.RData")
load("data_outputs/bootstrap_all.RData")
all_data <- left_join(bootstrap_all,species_basic,by="species_code")
all_data1 <- all_data %>%
group_by(season, sw_foraging, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3_for <- all_data1 %>%
pivot_longer(!c("season","sw_foraging","state"), names_to = "No.", values_to = "PD" )
all_data4_for <- all_data3_for %>%
pivot_wider(names_from = "state", values_from = "PD")
all_data4_for <- all_data4_for %>%
mutate(SHM = (natural+1)/(modified+1))
all_data4_for$season <- factor(all_data4_for$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
pd_aov <- aov(ratio~season*sw_foraging, data = all_data4)
pd_aov <- aov(ratio~season*sw_foraging, data = all_data4_for)
pd_aov <- aov(SHM~season*sw_foraging, data = all_data4_for)
pd_lm <- lm(SHM~season*sw_foraging, data = all_data4_for)
summary(pd_aov)
summary(pd_lm)
AIC(pd_lm)
#assumptions
par(mfrow=c(2,2))
plot(pd_lm)
for.holm.pd.table <- emmeans(pd_aov, list(pairwise ~ sw_foraging*season), adjust = "holm")
summary(for.holm.pd.table)
write.table(for.holm.pd.table$`pairwise differences of sw_foraging, season`, file = "fig_outputs/for-holm-pd.txt", sep = ",", quote = FALSE, row.names = F)
library(lme4)
library(nlme)
library(car)
library(tidyverse)
library(lmerTest)
library(MuMIn)
library(effectsize)
library(emmeans)
library(lattice)
library(ggpubr)
library(rstatix)
library(ggsci)
library(ggsignif)
load("data/species_basic.RData")
load("data_outputs/bootstrap_all.RData")
all_data <- left_join(bootstrap_all,species_basic,by="species_code")
#summing natural and modified land cover PDs for each mig strat in each season
#and calculating the proportion positive for each
#yields 1000 proportions for each grouping
all_data1 <- all_data %>%
group_by(season, SW_mig, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
#long format (bootstrap reps)
all_data3_mig <- all_data1 %>%
pivot_longer(!c("season","SW_mig","state"), names_to = "No.", values_to = "Proportion_Positive" )
#wide format to separate natural and modified values to calculate ratio
all_data4_mig <- all_data3_mig %>%
pivot_wider(names_from = "state", values_from = "Proportion_Positive")
#calculate SHM - proportion positive natural relative to proportion positive modified
all_data4_mig <- all_data4_mig %>%
mutate(SHM = (natural+1)/(modified+1))
all_data4_mig$season <- factor(all_data4_mig$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
all_data4_mig$SW_mig <- factor(all_data4_mig$SW_mig, levels=c("N","S","NR","R"))
save(all_data4_mig, file = "data_outputs/all_data4_mig.RData")
load("data/species_basic.RData")
load("data_outputs/bootstrap_all.RData")
all_data <- left_join(bootstrap_all,species_basic,by="species_code")
all_data1 <- all_data %>%
group_by(season, diet2, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3_diet <- all_data1 %>%
pivot_longer(!c("season","diet2","state"), names_to = "No.", values_to = "PD" )
all_data4_diet <- all_data3_diet %>%
pivot_wider(names_from = "state", values_from = "PD")
all_data4_diet <- all_data4_diet %>%
mutate(SHM = (natural+1)/(modified+1))
all_data4_diet$season <- factor(all_data4_diet$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
save(all_data4_diet, file = "data_outputs/all_data4_diet.RData")
load("data/species_basic.RData")
load("data_outputs/bootstrap_all.RData")
all_data <- left_join(bootstrap_all,species_basic,by="species_code")
all_data1 <- all_data %>%
group_by(season, sw_foraging, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3_for <- all_data1 %>%
pivot_longer(!c("season","sw_foraging","state"), names_to = "No.", values_to = "PD" )
all_data4_for <- all_data3_for %>%
pivot_wider(names_from = "state", values_from = "PD")
all_data4_for <- all_data4_for %>%
mutate(SHM = (natural+1)/(modified+1))
all_data4_for$season <- factor(all_data4_for$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
save(all_data4_for, file = "data_outputs/all_data4_for.RData")
load("data_outputs/IHM_migrants_2019.RData")
IHM_sep <- migrants_2019 %>%
pivot_longer(cols = c("natural1","impacted1"), names_to = "state", values_to = "rPI")
ggplot(aes(y = rPI, x = season, fill = state), data = SHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(~SW_mig)
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(~SW_mig)
names <- list(
'N'="Neotropical Migrant",
'NR'="Neotropical Resident",
'R'="North American Resident",
'S'="Short-distance Migrant"
)
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(~SW_mig, labeller = as_labeller(names))
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_grid(.~SW_mig, labeller = as_labeller(names))
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
names <- c(
'N'="Neotropical Migrant",
'NR'="Neotropical Resident",
'R'="North American Resident",
'S'="Short-distance Migrant"
)
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("rPI") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Impacted","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Impacted","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
figs10 <- ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Impacted","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
figS10 <- ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Impacted","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
png("appendix_plots/figureS10.png", height = 8, width = 11.5, units = "in",res=300)
figS10
dev.off()
figS10 <- ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Impacted","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
png("appendix_plots/figureS10.png", height = 8, width = 11.5, units = "in",res=300)
figS10
dev.off()
load("data_outputs/all_data4_mig.RData")
load("data/species_basic.RData")
load("data_outputs/bootstrap_all.RData")
all_data <- left_join(bootstrap_all,species_basic,by="species_code")
all_data1 <- all_data %>%
group_by(season, SW_mig, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3 <- all_data1 %>%
pivot_longer(!c("season","SW_mig","state"), names_to = "No.", values_to = "Proportion Positive" )
all_data3$season <- factor(all_data3$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
View(all_data3)
all_data3 <- all_data1 %>%
pivot_longer(!c("season","SW_mig","state"), names_to = "No.", values_to = "PP" )
all_data3$season <- factor(all_data3$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic() +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg()+
facet_wrap(~SW_mig)
ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Natural","Modified"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
figS10 <- ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
png("appendix_plots/figureS10.png", height = 8, width = 11.5, units = "in",res=300)
figS10
dev.off()
figS11 <- ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~SW_mig, labeller = as_labeller(names))
png("appendix_plots/figureS11.png", height = 8, width = 11.5, units = "in",res=300)
figS11
dev.off()
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~diet2)
names <- c(
'C'="Carnivore",
'F'="Frugivore",
'G'="Granivore",
'I'="Insectivore",
'O'="Omnivore"
)
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~diet2, labeller = as_labeller(names))
figS12 <- ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~diet2, labeller = as_labeller(names))
png("appendix_plots/figureS12.png", height = 8, width = 11.5, units = "in",res=300)
figS12
dev.off()
all_data1 <- all_data %>%
group_by(season, diet2, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3 <- all_data1 %>%
pivot_longer(!c("season","diet2","state"), names_to = "No.", values_to = "PP" )
all_data3$season <- factor(all_data3$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~diet2, labeller = as_labeller(names))
figS13 <- ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~diet2, labeller = as_labeller(names))
png("appendix_plots/figureS13.png", height = 8, width = 11.5, units = "in",res=300)
figS13
dev.off()
unique(migrants_2019$sw_foraging)
names <- c(
'F'="Foliage Gleaner",
'B'="Bark Forager",
'G'="Ground Forager",
'AF'="Aerial Forager",
'GH'="Ground Hawker",
'AH'="Aerial Hawker"
)
ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~sw_foraging, labeller = as_labeller(names))
figS14 <- ggplot(aes(y = rPI, x = season, fill = state), data = IHM_sep)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Relative Predictor Importance") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~sw_foraging, labeller = as_labeller(names))
png("appendix_plots/figureS14.png", height = 8, width = 11.5, units = "in",res=300)
figS14
dev.off()
all_data1 <- all_data %>%
group_by(season, sw_foraging, state) %>%
summarise(across(where(is.numeric), ~sum(.>0)/length(.)))
all_data3 <- all_data1 %>%
pivot_longer(!c("season","sw_foraging","state"), names_to = "No.", values_to = "PP" )
all_data3$season <- factor(all_data3$season, levels=c("breeding", "postbreeding","nonbreeding", "prebreeding"))
ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~diet2, labeller = as_labeller(names))
ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~sw_foraging, labeller = as_labeller(names))
figS15 <- ggplot(aes(y = PP, x = season, fill = state), data = all_data3)+
geom_boxplot()+
theme_classic(base_size = 22, base_family = "serif") +
xlab("Season") +
ylab("Proportion Positive") +
labs(fill = "State") +
theme(axis.text.x = element_text(angle = 45, hjust=1))+
scale_fill_npg(labels = c("Modified","Natural"))+
facet_wrap(.~sw_foraging, labeller = as_labeller(names))
png("appendix_plots/figureS15.png", height = 8, width = 11.5, units = "in",res=300)
figS15
dev.off()
