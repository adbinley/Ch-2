#detach(package:ebirdst)
}
library(beepr)
beep("mario")
#breeding_rabd <- list()
save(nonbreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
load("D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
for(i in 90:140){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_end_dt"]]}
nonbre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
nonbre_extent <- ebirdst_extent(ext,
t = nonbre)
#nonbreeding
nonbre_abd <- ebirdst_subset(abd, ext = nonbre_extent)
rm(abd)
nonbre_abd_mean <- calc(nonbre_abd, mean)
rm(nonbre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- nonbre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
nonbreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
library(beepr)
beep("mario")
#breeding_rabd <- list()
save(nonbreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
load("D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
for(i in 136:180){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_end_dt"]]}
nonbre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
nonbre_extent <- ebirdst_extent(ext,
t = nonbre)
#nonbreeding
nonbre_abd <- ebirdst_subset(abd, ext = nonbre_extent)
rm(abd)
nonbre_abd_mean <- calc(nonbre_abd, mean)
rm(nonbre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- nonbre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
nonbreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
library(beepr)
beep("mario")
#breeding_rabd <- list()
save(nonbreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
load("D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
for(i in 180:238){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_end_dt"]]}
nonbre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
nonbre_extent <- ebirdst_extent(ext,
t = nonbre)
#nonbreeding
nonbre_abd <- ebirdst_subset(abd, ext = nonbre_extent)
rm(abd)
nonbre_abd_mean <- calc(nonbre_abd, mean)
rm(nonbre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- nonbre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
nonbreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
#breeding_rabd <- list()
save(nonbreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
load("D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
for(i in 208:238){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_end_dt"]]}
nonbre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
nonbre_extent <- ebirdst_extent(ext,
t = nonbre)
#nonbreeding
nonbre_abd <- ebirdst_subset(abd, ext = nonbre_extent)
rm(abd)
nonbre_abd_mean <- calc(nonbre_abd, mean)
rm(nonbre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- nonbre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
nonbreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
library(beepr)
beep("mario")
#breeding_rabd <- list()
save(nonbreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
load("D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
for(i in 235:238){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["nonbreeding_end_dt"]]}
nonbre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
nonbre_extent <- ebirdst_extent(ext,
t = nonbre)
#nonbreeding
nonbre_abd <- ebirdst_subset(abd, ext = nonbre_extent)
rm(abd)
nonbre_abd_mean <- calc(nonbre_abd, mean)
rm(nonbre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- nonbre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
nonbreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
#breeding_rabd <- list()
save(nonbreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/nonbreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
prebreeding_exp <- list()
for(i in 1:238){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["prebreeding_migration_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["prebreeding_migration_end_dt"]]}
prebre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
prebre_extent <- ebirdst_extent(ext,
t = prebre)
#prebreeding
prebre_abd <- ebirdst_subset(abd, ext = prebre_extent)
rm(abd)
prebre_abd_mean <- calc(prebre_abd, mean)
rm(prebre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- prebre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
prebreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
library(beepr)
beep("mario")
#breeding_rabd <- list()
save(prebreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/prebreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
load("D:/Allison/Big_data/eBird_outputs/prebreeding_exp.RData")
for(i in 63:238){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["prebreeding_migration_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["prebreeding_migration_end_dt"]]}
prebre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
prebre_extent <- ebirdst_extent(ext,
t = prebre)
#prebreeding
prebre_abd <- ebirdst_subset(abd, ext = prebre_extent)
rm(abd)
prebre_abd_mean <- calc(prebre_abd, mean)
rm(prebre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- prebre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
prebreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
#breeding_rabd <- list()
save(prebreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/prebreeding_exp.RData")
#land cover - best practices
#everything broken
library(ebirdst)
library(tidyverse)
library(raster)
#relative abundance for seasonal windows, multiplied by PLAND
mod_pland_ebd <- raster("D:/Allison/Big_data/Ch-2 landcover/modified_cover_ebd.tif")
#need updated run names
ebirdst_species <- ebirdst_runs %>%
dplyr::select(c("species_code","run_name"))
my_species <- read.csv("C:/Users/AllisonBinley/OneDrive - Carleton University/thesis/CH2_2021/data/bird_data_v4.csv")
my_species <- left_join(my_species, ebirdst_species, by = "species_code")
setwd("E:/eBird/data/raw/STEM")
load("D:/Allison/Big_data/eBird_outputs/prebreeding_exp.RData")
for(i in 121:238){
#for(i in 169:length(my_species$species_code)){
#for(i in 1:3){
#library(ebirdst)
code <- my_species$species_code[i]
run_name <- my_species$run_name.y[i]
skip_to_next <- FALSE
tryCatch(
#  pis <- load_pis(run_name), error = function(e){skip_to_next <<- TRUE})
abd <- load_raster(product = "abundance", path = run_name), error = function(e){skip_to_next <<- TRUE})
if(skip_to_next) { next }
start <- my_species %>%
filter(species_code==code)%>%
{.[["prebreeding_migration_start_dt"]]}
end <- my_species %>%
filter(species_code==code)%>%
{.[["prebreeding_migration_end_dt"]]}
prebre <- c(start, end)
ext_vec <-  c(xmin = -12240259, xmax = -1344534,
ymin = -6945058, ymax = 9202317)
ext <- sf::st_bbox(ext_vec, crs = "+proj=sinu +lon_0=0 +x_0=0 +y_0=0 +R=6371007.181 +units=m +no_defs")
prebre_extent <- ebirdst_extent(ext,
t = prebre)
#prebreeding
prebre_abd <- ebirdst_subset(abd, ext = prebre_extent)
rm(abd)
prebre_abd_mean <- calc(prebre_abd, mean)
rm(prebre_abd)
#breeding_rabd[[i]] <- bre_abd_mean
exposure <- prebre_abd_mean*mod_pland_ebd
exposure_vals <- getValues(exposure)%>%
na.omit()
exposure_vals <- exposure_vals[exposure_vals!=0]
prebreeding_exp[[i]]<- exposure_vals
rm(exposure)
#detach(package:ebirdst)
}
library(beepr)
beep("mario")
warnings()
View(prebreeding_exp)
#breeding_rabd <- list()
save(prebreeding_exp, file = "D:/Allison/Big_data/eBird_outputs/prebreeding_exp.RData")
library(tidyverse)
load("D:/Allison/Big_data/eBird_outputs/breeding_exp.RData")
func <- function(x) {
c(mean = mean(x), var = var(x))
}
test <- lapply(breeding_exp, func)
?lapply
View(breeding_exp)
test <- lapply(x=breeding_exp, func)
test <- lapply(x=breeding_exp, FUN=func)
View(breeding_exp)
l <- breeding_exp[[1]]
mean(l)
var(l)
test <- sapply(x=breeding_exp, FUN=func)
test <- sapply(X=breeding_exp, FUN=func)
#first rescue revi
library(ebirdst)
View(breeding_exp)
setwd("E:/eBird/data/raw/STEM")
getwd()
ebirdst_download(
species = "reevir1", #spec,
path = getwd(),
tifs_only = FALSE,
force = TRUE,
show_progress = TRUE
)
set_ebirdst_access_key("n9e2g499utv1", overwrite = T)
setwd("E:/eBird/data/raw/STEM")
ebirdst_download(
species = "reevir1", #spec,
path = getwd(),
tifs_only = FALSE,
force = TRUE,
show_progress = TRUE
)
#first rescue reevir1
library(ebirdst)
setwd("E:/eBird/data/raw/STEM")
ebirdst_download(
species = "reevir1", #spec,
path = getwd(),
tifs_only = FALSE,
force = TRUE,
show_progress = TRUE
)
set_ebirdst_access_key("n9e2g499utv1", overwrite = T)
set_ebirdst_access_key("n9e2g499utv1", overwrite = T)
library(ebirdst)
set_ebirdst_access_key("n9e2g499utv1", overwrite = T)
set_ebirdst_access_key("n9e2g499utv1", overwrite = F)
ebirdst_download(
species = "reevir1", #spec,
path = getwd(),
tifs_only = FALSE,
force = TRUE,
show_progress = TRUE
)
set_ebirdst_access_key("tb7or2boq2lc", overwrite = T)
#first rescue reevir1
library(ebirdst)
setwd("E:/eBird/data/raw/STEM")
ebirdst_download(
species = "reevir1", #spec,
path = getwd(),
tifs_only = FALSE,
force = TRUE,
show_progress = TRUE
)
